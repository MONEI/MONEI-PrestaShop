

function executeEveryNsecondsNtimes(e,n,o){intervalId=setInterval(function(){e(),++monei_counter!==o&&0!=number_of_retries||clearInterval(intervalId)},n)}function checkMoneiStatus(){setCountDown();let e={fc:"module",module:"monei",controller:"check",action:"payment",cart_id:monei_cart_id,order_id:monei_order_id,monei_id:monei_id,ajax:!0,monei_counter:monei_counter};url_monei_ajax.search=new URLSearchParams(e).toString(),fetch(url_monei_ajax,{method:"POST",headers:{Accept:"application/json"}}).then(e=>e.json()).then(e=>{void 0!==e.order_exists&&e.order_exists&&(clearInterval(intervalId),validateMoneiCart(monei_cart_id)),monei_counter==number_of_retries&&validateMoneiCart(monei_cart_id)}).catch(function(e){document.querySelector(".custom__modal").style.display="none",clearInterval(intervalId),swal(conf_msg_mon1_ko,conf_msg_mon2_ko,conf_mon_icon_ko),console.log("Error MONEI: "+e)})}function validateMoneiCart(e){let n=new URL(monei_index_url),o={fc:"module",module:"monei",controller:"check",action:"convert",cart_id:e,order_id:monei_order_id,monei_id:monei_id,ajax:!0,XDEBUG_SESSION_START:"xdebug1"};n.search=new URLSearchParams(o).toString(),fetch(n,{method:"POST",headers:{Accept:"application/json"}}).then(e=>e.json()).then(e=>{let n=document.getElementById("order_id_span"),o=document.createElement("span");o.id="order_id_span",o.innerHTML=e.order_reference,n.replaceWith(o);let t=document.getElementById("content"),r=document.createElement("div");r.classList.add("page-content","card","card-block"),r.id="content",r.innerHTML=e.content,t.replaceWith(r),swal(conf_msg_mon1_ok,conf_msg_mon2_ok,conf_mon_icon_ok)}).catch(function(e){document.querySelector(".custom__modal").style.display="none",clearInterval(intervalId),swal(conf_msg_mon1_ko,conf_msg_mon2_ko,conf_mon_icon_ko),console.log("Error MONEI: "+e)})}function setCountDown(){let e=time_retry_seconds*(number_of_retries-monei_counter),n=document.getElementById("countdown"),o=document.createElement("span");o.id="countdown";let t=Math.floor(e/60);t=t<10?"0"+t:t;let r=e-60*t;r=r<10?"0"+r:r,o.innerHTML=t+":"+r+" s.",n.replaceWith(o)}const time_retry_seconds=3,number_of_retries=20;let intervalId,monei_counter=0,url_monei_ajax=new URL(monei_index_url);document.addEventListener("DOMContentLoaded",function(e){setCountDown(),executeEveryNsecondsNtimes(checkMoneiStatus,1e3*time_retry_seconds,number_of_retries),document.querySelector(".custom__modal").style.display="block"});